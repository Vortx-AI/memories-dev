{% extends "!layout.html" %}

{%- block extrahead %}
  {{ super() }}
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Memory Codex Documentation - Earth-grounded AI memory systems">
  <link rel="stylesheet" href="{{ pathto('_static/css/custom.css', 1) }}" type="text/css" />
  
  <!-- Book JavaScript -->
  <script src="{{ pathto('_static/js/book.js', 1) }}"></script>
  
  <!-- Book Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:ital,wght@0,400;0,600;0,700;1,400;1,600&display=swap" rel="stylesheet">
  
  <style>
    /* Essential styles */
    body { 
      visibility: hidden; 
      margin: 0;
      padding: 0;
    }
    .book-reader { 
      visibility: visible !important; 
    }

    /* Mobile navigation */
    @media screen and (max-width: 768px) {
      .wy-nav-content-wrap {
        margin-left: 0;
      }
      .wy-nav-side {
        left: -300px;
        transition: left 0.3s ease;
      }
      .wy-nav-side.shift {
        left: 0;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
      }
    }
  </style>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      document.body.classList.add('book-reader');
      document.body.style.visibility = 'visible';
    });
  </script>
{% endblock %}

{% block content %}
<div class="wy-nav-content-wrap">
  <div class="wy-nav-content book-content">
    <!-- Reading progress -->
    <div class="reading-progress"></div>
    
    <div class="rst-content">
      <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
        <div itemprop="articleBody">
          <!-- Book content -->
          <div class="book-page">
            {% block document %}
              {{ super() }}
            {% endblock %}
          </div>
        </div>
      </div>
      
      <!-- Chapter navigation -->
      {% block navigation %}
      <div class="book-navigation">
        {%- if prev %}
          <a href="{{ prev.link|e }}" class="prev-chapter" title="{{ prev.title|striptags|e }}" accesskey="p">
            <span class="nav-text">{{ prev.title|striptags|e }}</span>
          </a>
        {%- endif %}
        {%- if next %}
          <a href="{{ next.link|e }}" class="next-chapter" title="{{ next.title|striptags|e }}" accesskey="n">
            <span class="nav-text">{{ next.title|striptags|e }}</span>
          </a>
        {%- endif %}
      </div>
      {% endblock %}
    </div>
  </div>
</div>
{% endblock %}

{% block footer %}
<div class="book-footer">
  <div class="book-copyright">
    <p>&copy; 2023-2024 Memory Codex. All rights reserved.</p>
  </div>
</div>
{% endblock %} 